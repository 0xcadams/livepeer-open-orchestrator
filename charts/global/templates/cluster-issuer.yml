---
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: '{{ .Chart.Name }}-letsencrypt-cluster-issuer'
  annotations:
    helm.sh/hook: "post-install,post-upgrade"
spec:
  acme:
    server: '{{ .Values.letsencrypt.api }}'
    email: '{{ .Values.letsencrypt.email }}'
    privateKeySecretRef:
      name: 'letsencrypt-issuer'
    solvers:
      - http01:
          ingress:
            class: nginx
            podTemplate:
              spec:
                nodeSelector:
                  'kubernetes.io/os': linux
